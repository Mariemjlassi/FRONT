<div class="experience-management-container">
    <!-- En-tête -->
    <div class="header-section">
        <h2><i class="pi pi-briefcase"></i> Gestion des Expériences Professionnelles</h2>
        <p class="subtitle">Gérez les parcours professionnels de vos collaborateurs</p>
    </div>

    <!-- Onglets -->
    <p-tabView>
        <!-- Onglet Expériences ASSAD -->
        <p-tabPanel header="Expériences ASSAD" leftIcon="pi pi-building">
            <div class="tab-content">
                <!-- Carte d'actions -->
                <div class="action-card">
                    <p-button label="Nouvelle expérience ASSAD" icon="pi pi-plus" 
                              severity="secondary" (click)="showDialogAddAssad()"></p-button>
                    <div class="stats">
                        <span class="stat-badge">
                            <i class="pi pi-history"></i> Total: {{experiencesAssad.length}}
                        </span>
                    </div>
                </div>

                <!-- Liste des expériences ou message vide -->
                <div *ngIf="experiencesAssad.length === 0" class="empty-state">
                    <div class="empty-illustration">
                        <i class="pi pi-inbox" style="font-size: 3rem; color: #a0aec0;"></i>
                    </div>
                    <h3>Aucune expérience ASSAD enregistrée</h3>
                    <p>Commencez par ajouter la première expérience professionnelle</p>
                    
                </div>

                <!-- Grille des expériences ASSAD -->
                <div *ngIf="experiencesAssad.length > 0" class="experience-list">
                    <div class="grid">
                        <div *ngFor="let exp of experiencesAssad | slice:0:(showAllAssad ? experiencesAssad.length : 5)" 
                             class="experience-card card assad-card">
                            <div class="card-badge assad-badge">
                                <i class="pi pi-building"></i> ASSAD
                            </div>
                            <div class="card-header">
                                <h4>{{exp.poste}}</h4>
                                <div class="card-meta">
                                    <span class="direction">
                                        <i class="pi pi-sitemap"></i> {{exp.direction}}
                                    </span>
                                    <span class="contract">
                                        <i class="pi pi-file"></i> {{exp.modeAffectation}}
                                    </span>
                                </div>
                            </div>
                            <div class="card-dates">
                                <i class="pi pi-calendar"></i>
                                {{exp.dateDebut | date:'dd/MM/yyyy'}} - {{exp.dateFin | date:'dd/MM/yyyy'}}
                            </div>
                            <div class="card-actions">
                                <p-button icon="pi pi-pencil" severity="info" 
                                          [rounded]="true" [text]="true"
                                          (click)="showDialogAssad(exp)"></p-button>
                                <p-button icon="pi pi-trash" severity="danger" 
                                          [rounded]="true" [text]="true"
                                          (click)="deleteExperienceAssad(exp.id!)"></p-button>
                            </div>
                        </div>
                    </div>

                    <!-- Bouton "Voir plus" pour ASSAD -->
                    <div *ngIf="experiencesAssad.length > 5" class="see-more-container">
                        <p-button *ngIf="!showAllAssad" label="Voir plus d'expériences ({{experiencesAssad.length - 5}})" 
                                  icon="pi pi-chevron-down" class="see-more-btn" 
                                  (click)="showAllAssad = true" severity="help"></p-button>
                        <p-button *ngIf="showAllAssad" label="Voir moins" icon="pi pi-chevron-up" 
                                  class="see-more-btn" severity="help" (click)="showAllAssad = false"></p-button>
                    </div>
                </div>
            </div>
        </p-tabPanel>

        <!-- Onglet Expériences Antérieures -->
        <p-tabPanel header="Expériences Antérieures" leftIcon="pi pi-history">
            <div class="tab-content">
                <div class="action-card">
                    <p-button label="Nouvelle expérience antérieure" icon="pi pi-plus" 
                              severity="secondary" (click)="showDialogAddAnterieure()"></p-button>
                    <div class="stats">
                        <span class="stat-badge">
                            <i class="pi pi-history"></i> Total: {{experiencesAnterieure.length}}
                        </span>
                    </div>
                </div>

                <div *ngIf="experiencesAnterieure.length === 0" class="empty-state">
                    <div class="empty-illustration">
                        <i class="pi pi-database" style="font-size: 3rem; color: #a0aec0;"></i>
                    </div>
                    <h3>Aucune expérience antérieure enregistrée</h3>
                    <p>Ajoutez les expériences professionnelles avant l'arrivée chez ASSAD</p>
                    <p-button label="Ajouter une expérience" icon="pi pi-plus" 
                              (click)="showDialogAddAnterieure()"></p-button>
                </div>

                <!-- Grille des expériences antérieures -->
                <div *ngIf="experiencesAnterieure.length > 0" class="experience-list">
                    <div class="grid">
                        <div *ngFor="let exp of experiencesAnterieure | slice:0:(showAllAnterieure ? experiencesAnterieure.length : 5)" 
                             class="experience-card card previous-card">
                            <div class="card-badge previous-badge">
                                <i class="pi pi-briefcase"></i> Antérieure
                            </div>
                            <div class="card-header">
                                <h4>{{exp.poste}}</h4>
                                <div class="card-meta">
                                    <span class="company">
                                        <i class="pi pi-building"></i> {{exp.societe}} - {{exp.id}}
                                    </span>
                                </div>
                            </div>
                            <div class="card-dates">
                                <i class="pi pi-calendar"></i>
                                {{exp.dateDebut | date:'dd/MM/yyyy'}} - {{exp.dateFin | date:'dd/MM/yyyy'}}
                            </div>
                            <div class="card-actions">
                                <p-button icon="pi pi-pencil" severity="info" 
                                          [rounded]="true" [text]="true"
                                          (click)="showDialogAnterieure(exp)"></p-button>
                                <p-button icon="pi pi-trash" severity="danger" 
                                          [rounded]="true" [text]="true"
                                          (click)="deleteExperienceAnterieure(exp.id!)"></p-button>
                            </div>
                        </div>
                    </div>

                    <!-- Bouton "Voir plus" pour les expériences antérieures -->
                    <div *ngIf="experiencesAnterieure.length > 5" class="see-more-container">
                        <p-button *ngIf="!showAllAnterieure" label="Voir plus d'expériences ({{experiencesAnterieure.length - 5}})" 
                                  icon="pi pi-chevron-down" class="see-more-btn" 
                                  (click)="showAllAnterieure = true" severity="help"></p-button>
                        <p-button *ngIf="showAllAnterieure" label="Voir moins" icon="pi pi-chevron-up" 
                                  class="see-more-btn" (click)="showAllAnterieure = false" ></p-button>
                    </div>
                </div>
            </div>
        </p-tabPanel>
    </p-tabView>

    <!-- Dialogues (gardés de votre version originale) -->
    <p-dialog header="Ajouter une Expérience ASSAD" [(visible)]="visibleAddAssad" [modal]="true" [style]="{ width: '50rem' }">
        <form [formGroup]="experienceAssadForm" (ngSubmit)="addExperienceAssad()">
            <div class="p-fluid">
            
                <!-- Date de début -->
                <div class="p-field p-mb-3">
                    <label for="debut_assad" class="p-text-bold">Date de début :</label>
                    <input id="debut_assad" type="date" formControlName="debut" pInputText 
                        class="p-inputtext p-component"
                        [ngClass]="{'p-invalid': experienceAssadForm.get('debut')?.invalid && experienceAssadForm.get('debut')?.touched}" />
                    <small *ngIf="experienceAssadForm.get('debut')?.invalid && experienceAssadForm.get('debut')?.touched" class="p-error">
                        La date de début est requise.
                    </small>
                </div>
            
                <!-- Date de fin -->
                <div class="p-field p-mb-3">
                    <label for="fin_assad" class="p-text-bold">Date de fin :</label>
                    <input id="fin_assad" type="date" formControlName="fin" pInputText 
                        class="p-inputtext p-component"
                        [ngClass]="{'p-invalid': experienceAssadForm.get('fin')?.invalid && experienceAssadForm.get('fin')?.touched}" />
                    <small *ngIf="experienceAssadForm.get('fin')?.invalid && experienceAssadForm.get('fin')?.touched" class="p-error">
                        La date de fin est requise.
                    </small>
                </div>
            
                <!-- Poste -->
                <div class="p-field p-mb-3">
                    <label for="poste_assad" class="p-text-bold">Poste :</label>
                    <p-dropdown id="poste_assad" formControlName="poste" [options]="postes" optionLabel="titre" 
                        placeholder="Sélectionner un poste" 
                        [ngClass]="{'p-invalid': experienceAssadForm.get('poste')?.invalid && experienceAssadForm.get('poste')?.touched}" />
                    <small *ngIf="experienceAssadForm.get('poste')?.invalid && experienceAssadForm.get('poste')?.touched" class="p-error">
                        Veuillez sélectionner un poste.
                    </small>
                </div>
            
                <!-- Direction -->
                <div class="p-field p-mb-3">
                    <label for="direction_assad" class="p-text-bold">Direction :</label>
                    <p-dropdown id="direction_assad" formControlName="direction" [options]="directions" optionLabel="nom_direction" 
                        placeholder="Sélectionner une direction" 
                        [ngClass]="{'p-invalid': experienceAssadForm.get('direction')?.invalid && experienceAssadForm.get('direction')?.touched}" />
                    <small *ngIf="experienceAssadForm.get('direction')?.invalid && experienceAssadForm.get('direction')?.touched" class="p-error">
                        Veuillez sélectionner une direction.
                    </small>
                </div>
            
                <!-- Mode d'affectation -->
                <div class="p-field p-mb-3">
                    <label for="mode_affectation_assad" class="p-text-bold">Mode d'affectation :</label>
                    <p-dropdown id="mode_affectation_assad" formControlName="modeAffectation" [options]="['CDD', 'CDI', 'Stage']" 
                        placeholder="Sélectionner" 
                        [ngClass]="{'p-invalid': experienceAssadForm.get('modeAffectation')?.invalid && experienceAssadForm.get('modeAffectation')?.touched}" />
                    <small *ngIf="experienceAssadForm.get('modeAffectation')?.invalid && experienceAssadForm.get('modeAffectation')?.touched" class="p-error">
                        Veuillez sélectionner un mode d'affectation.
                    </small>
                </div>
            
                <!-- Boutons -->
                <div class="p-d-flex p-jc-end">
                    <button type="button" (click)="visibleAddAssad = false" pButton label="Annuler" icon="pi pi-times" 
                            class="p-button-text p-button-rounded p-button-secondary p-mr-2"></button>
                    <button type="submit" pButton label="Ajouter" icon="pi pi-check" class="p-button-primary p-button-rounded" 
                            [disabled]="experienceAssadForm.invalid"></button>
                </div>
            
            </div>
        </form>
    </p-dialog>

    <p-dialog header="Ajouter une Expérience Antérieure" [(visible)]="visibleAddAnterieure" [modal]="true" [style]="{ width: '50rem' }">
        <form [formGroup]="experienceAnterieureForm" (ngSubmit)="addExperienceAnterieure()">
            <div class="p-fluid">
                <div class="p-field">
                    <label for="dateDebut">Date de début :</label>
                    <input id="dateDebut" type="date" formControlName="dateDebut" pInputText class="p-inputtext p-component" />
                </div>
    
                <div class="p-field">
                    <label for="dateFin">Date de fin :</label>
                    <input id="dateFin" type="date" formControlName="dateFin" pInputText class="p-inputtext p-component" />
                </div>
    
                
                <div class="p-field">
                    <label for="poste_assad">Poste :</label>
                    <p-dropdown id="poste_assad" formControlName="poste" [options]="postes" optionLabel="titre" placeholder="Sélectionner un poste" class="p-inputtext" [ngStyle]="{ 'margin-top': '10px' }"  />
                </div>
    
                <div class="p-field">
                    <label for="societe">Société :</label>
                    <input id="societe" type="text" formControlName="societe" pInputText class="p-inputtext p-component" />
                </div>
    
                <div class="p-d-flex p-jc-end">
                    <button type="button" (click)="visibleAddAnterieure = false" pButton label="Annuler" icon="pi pi-times" class="p-button-text p-button-rounded p-button-secondary"></button>
                    <button type="submit" pButton label="Ajouter" icon="pi pi-check" class="p-button-primary p-button-rounded"></button>
                </div>
            </div>
        </form>
    </p-dialog>
</div>

<!-- Ajoutez cette section pour la modification des expériences ASSAD -->
<div *ngIf="editingAssad" class="edit-experience-container">
    <div class="edit-experience-card">
        <h3>Modifier l'expérience ASSAD</h3>
        
        <form [formGroup]="experienceAssadForm" (ngSubmit)="updateExperienceAssad()">
            <div class="form-group">
                <label>Date de début</label>
                <input type="date" formControlName="debut" class="form-control">
            </div>
            
            <div class="form-group">
                <label>Date de fin</label>
                <input type="date" formControlName="fin" class="form-control">
            </div>
            
            <div class="form-group">
                <label>Poste</label>
                <p-dropdown [options]="postes" formControlName="poste" optionLabel="titre"></p-dropdown>
            </div>
            
            <div class="form-group">
                <label>Direction</label>
                <p-dropdown [options]="directions" formControlName="direction" optionLabel="nom_direction"></p-dropdown>
            </div>
            
            <div class="form-group">
                <label>Mode d'affectation</label>
                <p-dropdown [options]="['CDD', 'CDI', 'Stage']" formControlName="modeAffectation"></p-dropdown>
            </div>
            
            <div class="form-actions">
                <button pbutton type="button" class="btn btn-secondary" (click)="cancelEdit()">Annuler</button>
                <button pbutton type="submit" class="btn btn-primary">Enregistrer</button>
            </div>
        </form>
    </div>
</div>

<!-- Ajoutez cette section pour la modification des expériences antérieures -->
<div *ngIf="editingAnterieure" class="edit-experience-container">
    <div class="edit-experience-card">
        <h3>Modifier l'expérience antérieure</h3>
        
        <form [formGroup]="experienceAnterieureForm" (ngSubmit)="updateExperienceAnterieure()">
            <div class="form-group">
                <label>Date de début</label>
                <input type="date" formControlName="dateDebut" class="form-control">
            </div>
            
            <div class="form-group">
                <label>Date de fin</label>
                <input type="date" formControlName="dateFin" class="form-control">
            </div>
            
            <div class="form-group">
                <label>Poste</label>
                <p-dropdown [options]="postes" formControlName="poste" optionLabel="titre"></p-dropdown>
            </div>
            
            <div class="form-group">
                <label>Société</label>
                <input type="text" formControlName="societe" class="form-control">
            </div>
            
            <div class="form-actions">
                <button pbutton type="button" class="btn btn-secondary" (click)="cancelEdit()">Annuler</button>
                <button pbutton type="submit" class="btn btn-primary">Enregistrer</button>
            </div>
        </form>
    </div>
</div>